<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="This function takes in the output from a sparta occupancy model
or a three dimensional array. The first year is set to an index value for all
species and the average change across years for each species is used to
calculate the indicator. A species only contributes to the
dataset in years where the standard deviation across iterations
meets the sd threshold. Missing years in the middle a a species dataset are
filled in using interpolation."><title>Rescale species values for indicator using Lambda interpolation — lambda_indicator • BRCindicators</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Rescale species values for indicator using Lambda interpolation — lambda_indicator"><meta property="og:description" content="This function takes in the output from a sparta occupancy model
or a three dimensional array. The first year is set to an index value for all
species and the average change across years for each species is used to
calculate the indicator. A species only contributes to the
dataset in years where the standard deviation across iterations
meets the sd threshold. Missing years in the middle a a species dataset are
filled in using interpolation."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">BRCindicators</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.3.7</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/vignette.html">BRCindicators</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/BiologicalRecordsCentre/BRCindicators/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Rescale species values for indicator using Lambda interpolation</h1>
      <small class="dont-index">Source: <a href="https://github.com/BiologicalRecordsCentre/BRCindicators/blob/HEAD/R/lambda_indicator.r" class="external-link"><code>R/lambda_indicator.r</code></a></small>
      <div class="d-none name"><code>lambda_indicator.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function takes in the output from a sparta occupancy model
or a three dimensional array. The first year is set to an index value for all
species and the average change across years for each species is used to
calculate the indicator. A species only contributes to the
dataset in years where the standard deviation across iterations
meets the sd threshold. Missing years in the middle a a species dataset are
filled in using interpolation.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">lambda_indicator</span><span class="op">(</span></span>
<span>  <span class="va">input</span>,</span>
<span>  index <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  threshold_sd <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>  threshold_Rhat <span class="op">=</span> <span class="fl">1.1</span>,</span>
<span>  threshold_yrs <span class="op">=</span> <span class="fl">20</span>,</span>
<span>  upperQuantile <span class="op">=</span> <span class="fl">0.975</span>,</span>
<span>  lowerQuantile <span class="op">=</span> <span class="fl">0.025</span>,</span>
<span>  sample_size <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  year_range <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  region <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>input</dt>
<dd><p>Either a string giving the path to occupancy model output files
produced by sparta, or a three dimensional array [species, year, iteration].</p></dd>


<dt>index</dt>
<dd><p>The index value for the first year, defaults to 100.</p></dd>


<dt>threshold_sd</dt>
<dd><p>The threshold standard deviation for a species-year value
to be included. If the standard deviation is above this value it is removed.</p></dd>


<dt>threshold_Rhat</dt>
<dd><p>The threshold Rhat value for a species-year value
to be included. If the Rhat is above this value it is removed. This rule will
only be used when <code>input</code> is a path to sparta output.</p></dd>


<dt>threshold_yrs</dt>
<dd><p>Numeric, the minimum number of years that a species must
fulfill the threshold_sd for it to be included.</p></dd>


<dt>upperQuantile</dt>
<dd><p>The upper confidence interval to use (as a probability)</p></dd>


<dt>lowerQuantile</dt>
<dd><p>The lower confidence interval to use (as a probability)</p></dd>


<dt>sample_size</dt>
<dd><p>numeric, if not NULL then a subsample of the iterations are 
used, equal to the number given. This is useful when datasets are so large
that memory starts to become limiting.</p></dd>


<dt>year_range</dt>
<dd><p>numeric vector of length 2 giving the start and end year of the 
data to be analysed.</p></dd>


<dt>region</dt>
<dd><p>Specify the region or aggregate data for which the indicator will 
be produced (for example: ENGLAND, WALES, SCOTLAND). The region name should match
the name used when running occDetFunc. If NULL (default) the function will be run 
on the full data (psi.fs).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A list with five elements: a summary (data.frame), the LogLambda values
(a three dimensional array, species - year - iterations), calculated after
removing species that fail thresholds and including interpolation, the raw
indicator value (a value for each iteration in each year), the average annual
percentage change for each species (the fist year is ignored as change is 0),
and a table giving the 'good' years for each species as defined by the thresholds.
Please note that the number of species contributing to the first year is 0 as this 
is fixed to the index value.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">### Running from an array ####</span></span></span>
<span class="r-in"><span><span class="co"># number of species</span></span></span>
<span class="r-in"><span><span class="va">nsp</span> <span class="op">=</span> <span class="fl">50</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># number of years</span></span></span>
<span class="r-in"><span><span class="va">nyr</span> <span class="op">=</span> <span class="fl">40</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#number of iterations</span></span></span>
<span class="r-in"><span><span class="va">iter</span> <span class="op">=</span> <span class="fl">500</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Build a random set of data</span></span></span>
<span class="r-in"><span><span class="va">myArray</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html" class="external-link">array</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">nsp</span><span class="op">*</span><span class="va">nyr</span><span class="op">*</span><span class="va">iter</span>,</span></span>
<span class="r-in"><span>                              mean <span class="op">=</span> <span class="fl">0.5</span>,</span></span>
<span class="r-in"><span>                              sd <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                 dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">nsp</span>, <span class="va">nyr</span>, <span class="va">iter</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                 dimnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">'SP'</span>,<span class="fl">1</span><span class="op">:</span><span class="va">nsp</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                                 <span class="fl">1</span><span class="op">:</span><span class="va">nyr</span>,</span></span>
<span class="r-in"><span>                                 <span class="fl">1</span><span class="op">:</span><span class="va">iter</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Ensure values are bounded by 0 and 1</span></span></span>
<span class="r-in"><span><span class="va">myArray</span><span class="op">[</span><span class="va">myArray</span> <span class="op">&gt;</span> <span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span></span></span>
<span class="r-in"><span><span class="va">myArray</span><span class="op">[</span><span class="va">myArray</span> <span class="op">&lt;</span> <span class="fl">0</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Run the lambda_indicator method on this data                </span></span></span>
<span class="r-in"><span><span class="va">myIndicator</span> <span class="op">&lt;-</span> <span class="fu">lambda_indicator</span><span class="op">(</span><span class="va">myArray</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Plot the indicator</span></span></span>
<span class="r-in"><span><span class="fu"><a href="plot_indicator.html">plot_indicator</a></span><span class="op">(</span><span class="va">myIndicator</span><span class="op">$</span><span class="va">summary</span><span class="op">[</span>,<span class="st">'indicator'</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>               <span class="va">myIndicator</span><span class="op">$</span><span class="va">summary</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'lower'</span> ,<span class="st">'upper'</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="lambda_indicator-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### Running from a directory of sparta ouput</span></span></span>
<span class="r-in"><span><span class="co"># myIndicator &lt;- lambda_indicator('myfilepath/myfolder')</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Dylan Carbone, Tom August, Gary Powney, Charlie Outhwaite, Jack Hatfield, Mark Logie, Stephen Freeman, Nick Isaac.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer></div>

  

  

  </body></html>

